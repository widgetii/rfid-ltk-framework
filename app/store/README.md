Хранилище тегов RFID
====================

Хранилище тегов - это приложение, ответственное за получение данных от
накопителей и их хранение в базу данных.

Для каждого профиля накопителя хранилище позволяет создать приёмник. Этот
приёмник и ответственен за приём данных от накопителя.

Веб-интерфейс управления приёмниками находится по адресу
`http://<server>/rfid/`.


Сборка
------

Сборка приложения осуществляется командой `ant`. Файлы настроек приложения
копируется из выбранного профиля сборки, указанного в качестве параметра в виде:
`ant -Dprofile=<profile>`, гдк `<profile>` - это имя профиля.

Профиль сборки - имя поддиректория, которая ищется вначале в директории `local`,
а если не найдена там - то в директории `profiles`. Если имя профиля сборки не
указано, то используется профиль `default`. Файлы из профиля `default` также
копируются, если отсутствуют в выбранном профиле.

Профили, находящиеся в директории `local` исключены из системы контроля версий,
в отличие от профилей, находящихся в директории `profiles`.

Доступные файлы настроек:

- `store.properties` - настройки JDBC соединения с базой данных.
- `users.properties` - список пользователей приложения в формате:
  `username=password,grantedAuthority[,grantedAuthority][,enabled|disabled]`
  (см. [Spring Security][user-service]), где:
    - `username` - это имя пользователя,
    - `password` - это хеш пароля по алгоритму SHA256,
    - `grantedAuthority` - роль пользователя, единственное возможное значение на
      данный момент - `ROLE_USER`,
    - флаг `disabled` отключает пользователя.

Хеши паролей можно вычислить с помощью скрипта `app/hash.sh`.


[user-service]: http://docs.spring.io/spring-security/site/docs/3.1.4.RELEASE/reference/appendix-namespace.html#nsa-user-service-attributes


Установка
---------

Приложение предназначено для работы под управлением сервера приложений Virgo
с установленными в нём зависимостями. Собранный командой `ant` архив приложения
`.par` помещается в директорию `target`. Для запуска приложения его необходимо
поместить в директорию `VIRGO_HOME/pickup`, где `VIRGO_HOME` - это корневая
директория, в которую установлен сервер приложений Virgo.

Инструкции по установке Virgo находятся в директории
[app/virgo](../virgo/REAME.md).
